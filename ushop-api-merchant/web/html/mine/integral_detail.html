<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
<title>彩豆明细</title>
<link rel="stylesheet" type="text/css" href="../../css/style.css?v=20180131"/>
<style>
.xlir-li {
	margin-bottom: 1px;
	background: #fff;
}
.xlir-p1 {
	padding: 1em .8em;
	display: block;
	width: 55%;
}
.xllr-box .xllr-r {
	width: 45%;
	text-align: right;
	padding: 1em .8em 1em 0;
}
</style>
</head>
<body>
<div class="xlnav-box xlele-box">
	<div class="xlnav-content xlele-content">
		<img src="../../image/icon/titleBG.jpg">
		<h1 class="xlnav-title">彩豆明细</h1>
	</div>
</div>
<div class="xlbody-box">
	<div class="xlsh-box1" id="integralListBox">
		<div class="xlir-ul"></div>
		<div class="xl-refresh-prompt refreshPrompt hide"></div>
	</div>
</div>
<script src="../../script/jquery-1.12.4.min.js"></script>
<script src="../../script/common.js?v=20180131"></script>
<script src="../../script/defaultxl.js?v=20180131"></script>
<script>
"use strict";
$(function() {
	globalData.loadReady();//页面加载完成执行
	pageDataInit();//页面数据初始化
	domEventFn();//dom初始化事件绑定
	reloadDataFn();//所有需要从服务器加载的数据请求
});

//页面启动时，数据初始化
function pageDataInit(){
}
//dom事件绑定
function domEventFn(){
}


//所有需要从服务器加载的数据请求
function reloadDataFn(){
	//刷新数据请求函数
	integralListDataFn();//晒单数据请求
}


//晒单数据请求
function integralListDataFn(){
	var listItem = $('#integralListBox'),//列表项目
		listContent = listItem.find('.xlir-ul'),//列表容器
		refreshPrompt = listItem.find('.refreshPrompt');//加载中提示容器
	if(refreshPrompt.find('.isLoadingTrue').length > 0){//说明正在加载中……
		return false;
	}
	refreshPrompt.html(Common.listLoadingHTML());
	var _url = Common.domainUrl + '/ushop-api-merchant/api/user/account/point/listBy/' + Common.getUserId();
	Common.ajax(_url, 'get', {}, function(data){
		if(data.recordList){//表示数据请求成功
			if(data.recordList.length == 0){//表示请求到的数据为0
				listContent.html('');
				refreshPrompt.html('');
				Common.blankPageFn(listContent);//显示空白界面
				return false;
			}
			Common.blankPageFn(listContent, 'hide');//隐藏空白界面
			refreshPrompt.html('');
			var str = '';
			$.each(data.recordList, function(index, obj){
				if(obj.fundType == '1001'){
					obj.object.fundName = '彩豆';
				}
				str +=  
						'<div class="xlir-li">'+
							'<div class="xllr-box">'+
								'<a class="xlir-p1 ellipsis" href="integral_record.html?fundType=' + obj.fundType + '">' + obj.object.fundName + '</a>'+
								'<a class="xllr-r ellipsis" href="../mine/integral_conver.html?fundType=' + obj.fundType + '&platformId=' + obj.object.platformId + '&balance=' + obj.balance + '">累计：<span class="color-ff5534">' + obj.balance + '</span>彩豆</a>'+
							'</div>'+
						'</div>';
			});
			listContent.html(str);
		}else{
			refreshPrompt.html('加载失败！');
		}
	});
}

</script>
</body>
</html>
