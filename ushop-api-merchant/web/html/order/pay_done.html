<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
<title>支付完成</title>
<link rel="stylesheet" type="text/css" href="../../css/style.css?v=20180131"/>
<style>
.xlpde-box1 {
	background: #fff;
	text-align: center;
	padding: .5em .8em;
}
.xlpde-box2 {
	background: #fff;
	text-align: center;
	padding: .5em .8em;
}
.xlpde-box2 .xl-btn {
	margin-left: 30px;
}
.xlpde-box2 .xl-btn:first-child {
	margin-left: 0;
}
.xlpde-box3 {
	padding: .5em .8em;
}
.xlpde-box4 .xl-li-txt {
	line-height: 1.4em;
}
.xlpde-box4 .xlpde-p1 {
	font-size: 80%;
	color: #999;
}
</style>
</head>
<body>
<div class="xlnav-box xlele-box">
	<div class="xlnav-content xlele-content">
		<img src="../../image/icon/titleBG.jpg">
		<h1 class="xlnav-title">支付完成</h1>
	</div>
</div>
<div class="xlbody-box">
	<div class="xlpde-box1">
		<div>已完成支付，等待系统揭晓</div>
	</div>
	<div class="xlpde-box2">
		<a href="../draw_lottery/shopping.html" class="xl-btn">继续彩购</a>
	</div>
	<div class="xlpde-box3">参与信息如下：</div>
	<div class="xlpde-box4">
		<ul class="xl-ul" id="payDoneList">
			<!--<li class="xl-li xl-lii">
				<a>
					<img class="xl-li-img" src="../../image/icon/img_detial.png">
					<div class="xl-li-txt">
						<div>灌装铁棍上药</div>
						<div class="xlpde-p1 clearfix">
							<span class="pull-left">期号：98</span>
							<span class="pull-right">参与人次：1</span>
						</div>
					</div>
				</a>
			</li>-->
		</ul>
	</div>
</div>
<script src="../../script/jquery-1.12.4.min.js"></script>
<script src="../../script/common.js?v=20180131"></script>
<script src="../../script/defaultxl.js?v=20180131"></script>
<script>
"use strict";
globalData.isProgress = false;
$(function() {
	globalData.loadReady();//页面加载完成执行
	pageDataInit();//页面数据初始化
	domEventFn();//dom初始化事件绑定
	reloadDataFn();//所有需要从服务器加载的数据请求
});

//页面启动时，数据初始化
function pageDataInit(){
	globalData.buyCount = globalData.pageParam.buyCount;
	globalData.buyData = JSON.parse(decodeURIComponent(globalData.pageParam.buyData));
	globalData.productData = JSON.parse(decodeURIComponent(globalData.pageParam.productData));
	payDoneListFn();
}
//dom事件绑定
function domEventFn(){
}

//所有需要从服务器加载的数据请求
function reloadDataFn(){
}

//刷新之后执行函数
function refreshAfterFn(){
	//说明页面所有请求都已经完成
	if(globalData.refreshComplete >= globalData.requestNum){
		globalData.refreshComplete = 0;//用来记录请求完成次数，记录归零
		globalData.requestNum = 0;//用来记录有多少次用户请求，记录归零
		if(globalData.isRefresh == true){
			globalData.isRefresh = false;
			Common.toast('刷新成功');
		}
	}
}

//购买完成后的数据呈现
function payDoneListFn(){
	var productData = globalData.productData,
		buyData = globalData.buyData,
		boughtCount = buyData.recordList[0].boughtCount,
		imgUrl = '../../image/p200200.png';
	if(productData.detail.object.headImage){
		imgUrl = Common.getImageUrl(productData.detail.object.headImage);
	}
	var a = '', b = '';
	if(boughtCount < 1){
		a = '<small class="color-ff5534">（参与失败）</small>';
		b = '<div class="xlpde-p1">失败原因：<span class="color-ff5534">商品疯抢，剩余人次不足</span></div>'
	}
	var str = 
		'<li class="xl-li xl-lii">'+
			'<a>'+
			'<img class="xl-li-img" src="' + imgUrl + '">'+
			'<div class="xl-li-txt">'+
				'<div>' + productData.detail.object.productName + a + '</div>'+
				'<div class="xlpde-p1 clearfix">'+
					'<span class="pull-left">期号：' + productData.detail.productPeriod + '</span>'+
					'<span class="pull-right">参与人次：' + boughtCount + '</span>'+
				'</div>'+
				b+
			'</div>'+
			'</a>'+
		'</li>';
	$('#payDoneList').html(str);
}
</script>
</body>
</html>
